---
layout:       post
title:        "在docker中安装lcov2.3"
author:       "shensunbo"
header-style: text
catalog:      true
tags:
    - docker
    - lcov
---
# dockerfile
```
FROM ubuntu:22.04

# Set non-interactive environment
ENV DEBIAN_FRONTEND=noninteractive

# Install basic tools and Python environment
RUN apt-get update && apt-get install -y --no-install-recommends \
    wget \
    curl \
    git \
    build-essential \
    python3 \
    python3-pip \
    python3-venv \
    cpanminus \
    libosmesa-dev \
    libgles2-mesa-dev \
    mesa-utils \
    libegl1-mesa-dev \
    && rm -rf /var/lib/apt/lists/*

# Install lcov-cobertura
RUN pip3 install lcov-cobertura

# Install base Perl environment required for Lcov 2.3
RUN apt-get update && apt-get install -y --no-install-recommends \
    make \
    perl \
    libperl-dev \
    && rm -rf /var/lib/apt/lists/*

# Use cpanm to install Perl modules
RUN cpanm --notest \
    Capture::Tiny \
    DateTime \
    Devel::Cover \
    Digest::MD5 \
    File::Spec \
    JSON::XS \
    Memory::Process \
    Module::Load::Conditional \
    Scalar::Util \
    Time::HiRes \
    TimeDate

# Install Lcov 2.3
WORKDIR /tmp
RUN wget https://github.com/linux-test-project/lcov/releases/download/v2.3/lcov-2.3.tar.gz \
    && tar -xzf lcov-2.3.tar.gz \
    && cd lcov-2.3 \
    && make install \
    && rm -rf /tmp/lcov*

# Verify installation
RUN lcov --version \
    && python3 --version

# Set working directory and user
ARG USERNAME=devuser
ARG USER_UID=1000
ARG USER_GID=1000
RUN groupadd --gid ${USER_GID} ${USERNAME} \
    && useradd --uid ${USER_UID} --gid ${USER_GID} -m ${USERNAME} \
    && mkdir -p /workspace \
    && chown -R ${USERNAME}:${USERNAME} /workspace

WORKDIR /workspace
USER ${USERNAME}
```

# run
```
sudo docker run -it --rm my-dev-env /bin/bash
```